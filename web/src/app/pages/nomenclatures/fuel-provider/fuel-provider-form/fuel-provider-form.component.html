<form [formGroup]="form" (ngSubmit)="onSubmit()" *ngIf="form">
  <div nz-row nzGutter="24">
    <div nz-col nzSpan="10">
      <nz-card>
        <div nz-row nzGutter="24">
          <div nz-col nzSpan="24">
            <lib-form-item label="ID" labelSpan="24">
              <lib-text-input id="id" formControlName="id"></lib-text-input>
            </lib-form-item>
          </div>
          <div nz-col nzSpan="24">
            <lib-form-item label="Име" labelSpan="24">
              <lib-text-input id="name" formControlName="name"></lib-text-input>
            </lib-form-item>
          </div>
          <div nz-col nzSpan="24">
            <lib-form-item>
              <label nz-checkbox id="active" formControlName="active"
                >Активен</label
              >
            </lib-form-item>
          </div>
        </div>
      </nz-card>
    </div>
    <div nz-col nzSpan="14">
      <nz-card
        nzTitle="Горива"
        [nzSize]="'small'"
        [nzBodyStyle]="{ padding: '10px 15px' }"
        [nzExtra]="extraTemplate"
      >
        <div
          formArrayName="fuelOptions"
          *ngIf="form.get('fuelOptions')?.value.length > 0"
        >
          <div
            nz-col
            nzSpan="24"
            class="container"
            *ngFor="
              let item of getFuelOptionsControls;
              index as loadProfilesIndex
            "
          >
            <div nz-row [formGroupName]="loadProfilesIndex" nzGutter="20">
              <div nz-col nzSpan="11">
                <lib-form-item label="Наименование">
                  <lib-text-input
                    id="name{{ loadProfilesIndex }}"
                    formControlName="name"
                  ></lib-text-input>
                </lib-form-item>
              </div>
              <div nz-col nzSpan="6">
                <lib-form-item label="Цена">
                  <lib-number-input
                    id="price{{ loadProfilesIndex }}"
                    formControlName="price"
                  >
                  </lib-number-input>
                </lib-form-item>
              </div>
              <div nz-col>
                <lib-form-item>
                  <button
                    type="button"
                    id="remove"
                    nz-button
                    nzType="default"
                    (click)="removeLoadProfiles(loadProfilesIndex)"
                  >
                    Премахни
                  </button>
                </lib-form-item>
              </div>
            </div>
          </div>
        </div>
        <div nz-col nzSpan="24" *ngIf="form.value.fuelOptions.length === 0">
          Няма добавени горива
        </div>
      </nz-card>
    </div>
  </div>

  <ng-template #extraTemplate>
    <button
      type="button"
      id="add"
      nz-button
      nzType="default"
      (click)="addFuelOption()"
    >
      <i nz-icon nzType="plus"></i>
      <span>Добави гориво</span>
    </button>
  </ng-template>

  <div nz-row nzGutter="20" nzJustify="end" style="margin: 10px">
    <div nz-col>
      <button nz-button type="submit" nzType="primary">
        {{ form.value.way4bill_id ? "Актуализирай" : "Запиши" }}
      </button>
    </div>
  </div>
</form>
